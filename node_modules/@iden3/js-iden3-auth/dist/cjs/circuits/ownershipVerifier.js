"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.IDOwnershipPubSignals = void 0;
const js_iden3_core_1 = require("@iden3/js-iden3-core");
class IDOwnershipPubSignals {
    async verifyIdOwnership(sender, challenge) {
        const userDID = js_iden3_core_1.DID.parseFromId(this.userId);
        if (sender !== userDID.toString()) {
            throw new Error(`sender is not used for proof creation, expected ${sender}, user from public signals: ${this.userId.string()}`);
        }
        if (challenge !== this.challenge) {
            throw new Error(`challenge is not used for proof creation, expected ${challenge}, challenge from public signals: ${this.challenge}  `);
        }
    }
}
exports.IDOwnershipPubSignals = IDOwnershipPubSignals;
//# sourceMappingURL=ownershipVerifier.js.map